---
title: "Análisis de incendios en Bejaia y Sidi"
output:
  html_document: default
  word_document: default
  pdf_document: default
date: "2025-11-05"
editor_options: 
  markdown: 
    wrap: 72
---

1.  Cargamos las librerías necesarias y la base de datos. También
    limpiaremos la base de datos por si hay espacios en blanco.

```{r}
library(dplyr)
library(ggplot2)
library(modeest)
library(stringr)
library(psych)
tabla <- read.csv("bd1_8.csv", sep=";", header= TRUE)
head(tabla)

# Limpiamos la tabla de datos
tabla <- tabla %>%
  mutate(across(where(is.character), ~trimws(.)))
tabla$id <- 1:nrow(tabla)
```

Vemos que en hay 2 regiones: Sidi y bejaia. Así como los días del mes
que corresponden a cada dato. Por lo que respectan a las variables
tenemos:

Temperature (°C): Temperatura media del día.<br> RH (%): Humedad
relativa.<br> Ws (km/h): Velocidad del viento.<br> Rain (mm):
Precipitación diaria.<br> FFMC: Fine Fuel Moisture Code (humedad de
combustibles finos).<br> DMC: Duff Moisture Code (humedad de la capa de
mantillo).<br> DC: Drought Code (severidad de la sequía).<br> ISI:
Initial Spread Index (índice de propagación inicial).<br> BUI: Build Up
Index (acumulación de combustible).<br> FWI : Fire Weather Index (índice
meteorológico de incendios).<br> Classes: "fire" o "not fire".<br>
Region: Bejaia y Sidi-Bel Abbes<br>

A continuación vamos a filtrar la base de datos según la región y si
hubieron o no incendios

```{r}
# Filtramos por Bejaia
Bejaia <- tabla %>% 
  filter(Region == "Bejaia")

#Filtramos por Bejaia y si hay o no incendio
Bejaia_fire <- Bejaia %>%
  filter(Classes == "fire")
Bejaia_not_fire <- Bejaia %>% 
  filter(Classes == "not fire")

# Filtramos por Sidi
Sidi <- tabla %>% 
  filter(Region == "Sidi-Bel_Abbes")

#Filtramos por Bejaia y si hay o no incendio
Sidi_fire <- Sidi %>%
  filter(Classes == "fire")
Sidi_not_fire <- Sidi %>% 
  filter(Classes == "not fire")

#Cuando hay o no fuego
not_fire <- tabla %>% 
  filter(Classes == "not fire")
fire <- tabla %>% 
  filter(Classes == "fire")
```

Vemos como quedan los incendios en cada zona para ver como son los datos

```{r}
ggplot(tabla, aes(Region, fill=Classes))+
  labs(title = "Cantidad de incendios por región")+
  geom_bar()+
  theme_minimal()
```

<br>Con el gráfico vemos que en Bejaia los días con fuego y sin fuego
son casi los mismos. En cambio, en Sidi-Bel_Abbes, vemos claramente que
han habido más días con incendios que sin.

Vamos a proceder a calcular las tablas de frecuencia en función de los
incendios por cada región para poder hacer una mejor comparación entre
los días que hubieron incendios y los días que no.

```{r}
Bejaia_frecuencias <- Bejaia %>% 
  group_by(Classes) %>% 
  summarise(ni = n()) %>% 
  mutate(fi = round(ni/sum(ni), 4)) %>% 
  mutate(fi_porc = round(fi*100, 2));Bejaia_frecuencias

Sidi_frecuencias <- Sidi %>% 
  group_by(Classes) %>% 
  summarise(ni = n()) %>% 
  mutate(fi = round(ni/sum(ni), 4)) %>% 
  mutate(fi_porc = round(fi*100, 2));Sidi_frecuencias
```

Tras hacer la tabla de frecuencias, vemos que en Bejaia hay casi los
mismo días con incendios que sin, mientras que en Sidi, hay casi el
doble de días con fuego que sin.

A continuación vamos a determinar qué factores contribuyen a los
incendios y lo haremos por región puesto que los factores que provocan
un incendio en un región no tienen por qué ser los mismos para la otra

## 1. LA LLUVIA

##### 1.1 Gráfico

Vamos a ver como la lluvia afecta a los incendios. Es por ello que vamos
a iniciar con un gráfico para ver como son los datos

```{r}
ggplot(tabla, aes(x=Region, y=Rain, color=Classes))+
  labs(title = "Lluvia por Región y Tipo de Incendio")+
  geom_boxplot()+
  theme_minimal()
```

<br>En el gráfico observamos que los días que hubieron incendios, no ha
habido casi lluvia. En cambio, los días en los que no han habido
incendios, sí ha llovido algo o mucho. En ambas regiones, vemos que los
datos son asimétricos a la derecha por lo que la mediana sería un mejor
representante de los datos que la mediana.

#### Bejaia

En el caso de Bejaia, podemos ver que cuando no ha habido incendio, el
50% de los datos centrales (cantidad de lluvia), viene representada por
la caja y está entre 0.1mm (Q1 calculado abajo) y 1.25mm (Q3), pero
también vemos que han habido muchos días en los que ha habido una
precipitación de entre 2.5mm hasta 16.8mm. Estos valores son lo que
están representados por puntos y son valores atípicos (outliers)<br>

#### Sidi

En el caso de Sidi, vemos que cuando hay incendios no suele haber lluvia
comparado con cuando no hay incendios. Tanto cuando hay como cuando no
hay incendio, podemos observar que hay 2 outliers. En concreto cuando ha
habido incendio, aunque haya llovido (los 2 puntos rojos) ha seguido
habiendo incendio.

#### 1.2 Vamos a analizar los datos

```{r}

lluvia_Bf <- Bejaia_fire %>% 
  summarize(media = mean(Rain),
          mediana = median(Rain),
          DM= mean(abs(Rain - media)),
          DM_med= mean(abs(Rain - mediana)),
          var = mean((Rain - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(Rain-mediana)),
          Q1 = quantile(Rain, prob=0.25),
          Q3 = quantile(Rain, prob=0.75),
          Curtosis = kurtosi(Rain)
          );lluvia_Bf

lluvia_Bnf <- Bejaia_not_fire%>% 
  summarize(media = mean(Rain),
          mediana = median(Rain),
          DM= mean(abs(Rain - media)),
          DM_med= mean(abs(Rain - mediana)),
          var = mean((Rain - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(Rain-mediana)),
          Q1 = quantile(Rain, prob=0.25),
          Q3 = quantile(Rain, prob=0.75),
          máximo = max(Rain),
          Curtosis = kurtosi(Rain)
          );lluvia_Bnf

lluvia_Sf <- Sidi_fire%>% 
  summarize(media = mean(Rain),
          mediana = median(Rain),
          DM= mean(abs(Rain - media)),
          DM_med= mean(abs(Rain - mediana)),
          var = mean((Rain - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(Rain-mediana)),
          Q1 = quantile(Rain, prob=0.25),
          Q3 = quantile(Rain, prob=0.75),
          Curtosis = kurtosi(Rain)
          );lluvia_Sf

lluvia_Snf <- Sidi_not_fire%>% 
  summarize(media = mean(Rain),
          mediana = median(Rain),
          DM= mean(abs(Rain - media)),
          DM_med= mean(abs(Rain - mediana)),
          var = mean((Rain - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(Rain-mediana)),
          Q1 = quantile(Rain, prob=0.25),
          Q3 = quantile(Rain, prob=0.75),
          Curtosis = kurtosi(Rain)
          );lluvia_Snf
```

Como en todos los casos la asimetría (curtosis) \> 0, la mediana es un
mejor representante., de hecho se puede comprobar viendo que la DM_med
\< DM

Tras ver el gráfico y los datos, vamos a analizar un poco más en
profundidad los resultados obtenidos. Para ambas regiones se cumple que:

-   la mediana de lluvia de días sin incendios siempre es mayor que
    cuando hay incendios.

-   el Q3 de los días con incendios, es menor que el Q1 de los días con
    incendio.

#### 1.3 Conclusiones

Tras analizar la lluvia podemos concluir que

-   la lluvia es más predecible en Bejaia respecto a Sidi: debido a que
    la cantidad de lluvia en los días que hay incendios no se entrelaza
    mucho con la cantidad de lluvia cuando no hay incendios.

-   Sidi no depende tanto de la lluvia comparado con Bejaia: esto se
    debe a que en Sidi vemos que valores atípicos siguen indicando fuego
    mientras que en Bejaia los valores no son tan extremos y está todos
    muy cerca de 0.

-   La lluvia es un factor relevante para los incendios: Como ya se ha
    analizado, Q3 (fuego) \< Q1 (no fuego) lo que hace que estén
    bastante diferenciado los datos.

## 2. RH, la humedad relativa

#### 2.1 Empezaremos con un gráfico para ver como quedan los datos

```{r}
ggplot(tabla, aes(x=Region, y=RH, fill=Classes))+
  labs(title = "Humedad Relativa por Región y Tipo de Incendio")+
  geom_boxplot()+
  theme_classic()
```

Podemos obsevar que en los días que hay fuego, la humedad relativa es
menor que cuando no hay fuego indicado por la barra negra dentro de las
cajas (mediana). Esto se cumple para ambas regiones.

Observamos también que los valores en Bejaia para cuando hay o no
incendio son más altos que en Sidi

#### 2.1 Ahora vamos a ver cómo son los datos

```{r}
RH_Bf <- Bejaia_fire%>% 
  summarize(media = mean(RH),
          mediana = median(RH),
          DM= mean(abs(RH - media)),
          DM_med= mean(abs(RH - mediana)),
          var = mean((RH - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(RH-mediana)),
          Q1 = quantile(RH, prob=0.25),
          Q3 = quantile(RH, prob=0.75),
          Curtosis = kurtosi(RH)
          );RH_Bf

RH_Bnf <- Bejaia_not_fire%>% 
  summarize(media = mean(RH),
          mediana = median(RH),
          DM= mean(abs(RH - media)),
          DM_med= mean(abs(RH - mediana)),
          var = mean((RH - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(RH-mediana)),
          Q1 = quantile(RH, prob=0.25),
          Q3 = quantile(RH, prob=0.75),
          Curtosis = kurtosi(RH)
          );RH_Bnf

RH_Sf <- Sidi_fire%>% 
  summarize(media = mean(RH),
          mediana = median(RH),
          DM= mean(abs(RH - media)),
          DM_med= mean(abs(RH - mediana)),
          var = mean((RH - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(RH-mediana)),
          Q1 = quantile(RH, prob=0.25),
          Q3 = quantile(RH, prob=0.75),
          Curtosis = kurtosi(RH)
          );RH_Sf

RH_Snf <- Sidi_not_fire%>% 
  summarize(media = mean(RH),
          mediana = median(RH),
          DM= mean(abs(RH - media)),
          DM_med= mean(abs(RH - mediana)),
          var = mean((RH - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(RH-mediana)),
          Q1 = quantile(RH, prob=0.25),
          Q3 = quantile(RH, prob=0.75),
          Curtosis = kurtosi(RH)
          );RH_Snf
```

Podemos concluir que la mediana es un mejor representante de los datos
puesto que aunque a veces sea por poco, la DM_med \< DM.

También podemos comparar los quantiles. En este caso, el Q1 en los días
sin incendio están muy poco por debajo del Q3 de los días en los que
hubieron incendios.

## 3. DMC (humedad en la capa del mantillo)

DMC se ve afectado por la temperatura, humaedad relativa y lluvia. Es la
humedad en la capa del mantillo

#### 3.1 El gráfico es el siguiente:

```{r}
ggplot(tabla, aes(x=Region, y=DMC, fill=Classes))+
  labs(title = "DMC por Región y Tipo de Incendio")+
  geom_boxplot()+
  theme_classic()
```

En el gráfico vemos que cuando no hay incendios, los valores de DMC son
más bajos que cuando hay incendios. En este caso, sonmuy parecidas las
gráficas de ambas regiones. Vemos que el 50% de los datos centrales de
fuego siempre están por encima del 50% central de cuando no hay fuego

```{r}
DMC_Bf <- Bejaia_fire%>% 
  summarize(media = mean(DMC),
          mediana = median(DMC),
          DM= mean(abs(DMC - media)),
          DM_med= mean(abs(DMC - mediana)),
          var = mean((DMC - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(DMC-mediana)),
          Q1 = quantile(DMC, prob=0.25),
          Q3 = quantile(DMC, prob=0.75)
          );DMC_Bf

DMC_Bnf <- Bejaia_not_fire%>% 
  summarize(media = mean(DMC),
          mediana = median(DMC),
          DM= mean(abs(DMC - media)),
          DM_med= mean(abs(DMC - mediana)),
          var = mean((DMC - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(DMC-mediana)),
          Q1 = quantile(DMC, prob=0.25),
          Q3 = quantile(DMC, prob=0.75)
          );DMC_Bnf

DMC_Sf <- Sidi_fire%>% 
  summarize(media = mean(DMC),
          mediana = median(DMC),
          DM= mean(abs(DMC - media)),
          DM_med= mean(abs(DMC - mediana)),
          var = mean((DMC - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(DMC-mediana)),
          Q1 = quantile(DMC, prob=0.25),
          Q3 = quantile(DMC, prob=0.75)
          );DMC_Sf

DMC_Snf <- Sidi_not_fire%>% 
  summarize(media = mean(DMC),
          mediana = median(DMC),
          DM= mean(abs(DMC - media)),
          DM_med= mean(abs(DMC - mediana)),
          var = mean((DMC - media)^2),
          sd = sqrt(var),
          CV = sd/media,
          DV = mean(abs(DMC-mediana)),
          Q1 = quantile(DMC, prob=0.25),
          Q3 = quantile(DMC, prob=0.75)
          );DMC_Snf
```

Con los datos, podemos afirmar que en Bejaia, cuando hay incendios Q1
(11.85) \> Q3 (7.85), no incendio. En Sidi ocurre lo mismo cuando hay
incendio Q1 (12.85) Q3 (9.65), no incendio.

Puesto que DMC mide la humedad, vamos a ver como se relaciona con la
lluvia

```{r}
ggplot(tabla, aes(Rain, DMC, color=Classes))+
  geom_point()+
  labs(title = "DMC en funció de Lluvia")

ggplot(tabla, aes(x = id)) +
  geom_line(aes(y = Rain, color = "Lluvia")) +
  geom_line(aes(y = DMC, color = "DMC")) +
  facet_wrap(~Region, scales = "free_x", ncol = 1) +
  scale_color_manual(
    name = "Variables",
    values = c("Lluvia" = "blue", "DMC" = "red")
  ) +
  labs(
    title = "Comparación de Lluvia y DMC entre regiones",
    x = "Registro (ID)",
    y = "Valores"
  ) +
  theme_minimal()


cor(Bejaia$DMC,Bejaia$Rain)
```

Vemos en el gráfico de líneas que la Lluvia afecta directamente a DMC,
cuando no llueve el mantillo está menos humedo y cuando llueve está más
húmedo. A menor valor de DMC, mayor será la humedad. En el gráfico de
puntos vemos que esto es correcto, a mayor lluvia menor humedad en el
mantillo y viceversa.

4.  Temperature (temperatura)

```{r}
temperatura_media_Bf <- Bejaia_fire %>% 
  summarize(máximo = max(Temperature),
            mínimo = min(Temperature),
            media = mean(Temperature),
            var = mean((Temperature - media)^2),
            sd = sqrt(var)
            );temperatura_media_Bf
temperatura_media_Bnf <- Bejaia_not_fire%>% 
  summarize(máximo = max(Temperature),
            mínimo = min(Temperature),
            media = mean(Temperature),
            mediana = median(Temperature),
            DM_me= mean(abs(Temperature - mediana)),
            var = mean((Temperature - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(Temperature-mediana))
            );temperatura_media_Bnf
temperatura_media_Sf <- Sidi_fire %>% 
  summarize(máximo = max(Temperature),
            mínimo = min(Temperature),
            media = mean(Temperature),
            var = mean((Temperature - media)^2),
            sd = sqrt(var)
            );temperatura_media_Sf
temperatura_media_Snf <- Sidi_not_fire%>% 
  summarize(máximo = max(Temperature),
            mínimo = min(Temperature),
            media = mean(Temperature),
            mediana = median(Temperature),
            DM_me= mean(abs(Temperature - mediana)),
            var = mean((Temperature - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(Temperature-mediana))
            );temperatura_media_Snf

ggplot(tabla, aes(x=Region, y=Temperature, fill=Classes))+
  labs(title = "Temperatura por Región e incendio")+
  geom_boxplot()
```

Tras el analisis de las temperaturas en Bejaia cuando han habido
incendios y no, podemos concluir, que las altas temperaturas contibuyen
a la aparicion de incendios, ya que como se observa en el gráfico cuando
las temperaturas son altas hay incendios, pero no son un factor muy
determinante.

Sin embargo también podemos notar que cuanto mas bajas son las
temperaturas menos incendios hay, aunque esto no implica que no hayan
habido incendios cuando hay bajas temperaturas.

En cuanto a Sidi podemos observar claras diferencias con Bejaia, en
primer lugar las temperaturas en esta zona son mucho mas elevadas (tanto
cuando ha habido incendios como no), además que al contrario que en
Bejaia aquí las altas temperaturas por lo general si suelen conllevar
siempre a la aparicion de incendios y las bajas temperaturas a la
ausencia de estos tal como se observa en el gráfico.

Calculamos la asimetria y la curtosis de la temperatura en Bejaia:

```{r}
ggplot(Bejaia, aes(x= Temperature)) +
  geom_bar(fill = "steelblue", color = "black")

Asimetria <- skew(Bejaia$Temperature); Asimetria

Curtosis <- kurtosi((Bejaia$Temperature)); Curtosis
```

Debido a una asimetria negativa tenemos que los datos de la temperatura
en Bejaia son asimetricos a la izquierda como se puede observar en la
gráfica ademas de que la curtosis es nagativa y por tanto la forma de
los datos es algo platicurtica

Ahora hacemos lo mismo pero en Sidi :

```{r}
ggplot(Sidi, aes(x= Temperature)) +
  geom_bar(fill = "steelblue", color = "black")

Asimetria <- skew(Sidi$Temperature); Asimetria
Curtosis <- kurtosi((Sidi$Temperature)); Curtosis
```

En el caso de Sidi debido a el resultado de la asimetria sabemos que los
datos son algo asimetricos a la izquierda aunque tambien algo simetricos
(como se observa en el grafico) y en este caso los datos son mas
platicurticos que en Bejaia

5.  FWI (índice meteorológico de incendios)

```{r}
FWI_media_Bf <- Bejaia_fire%>% 
  summarize(máximo = max(FWI),
            mínimo = min(FWI),
            media = mean(FWI),
            mediana = median(FWI),
            DM_me= mean(abs(FWI - mediana)),
            var = mean((FWI - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(FWI-mediana))
            );FWI_media_Bf
FWI_media_Bnf <- Bejaia_not_fire%>% 
  summarize(máximo = max(FWI),
            mínimo = min(FWI),
            media = mean(FWI),
            mediana = median(FWI),
            DM_me= mean(abs(FWI - mediana)),
            var = mean((FWI - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(FWI-mediana))
            );FWI_media_Bnf
FWI_media_Sf <- Sidi_fire%>% 
  summarize(máximo = max(FWI),
            mínimo = min(FWI),
            media = mean(FWI),
            mediana = median(FWI),
            DM_me= mean(abs(FWI - mediana)),
            var = mean((FWI - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(FWI-mediana))
            );FWI_media_Sf
FWI_media_Snf <- Sidi_not_fire%>% 
  summarize(máximo = max(FWI),
            mínimo = min(FWI),
            media = mean(FWI),
            mediana = median(FWI),
            DM_me= mean(abs(FWI - mediana)),
            var = mean((FWI - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(FWI-mediana))
            );FWI_media_Snf
ggplot(tabla, aes(Region, FWI, fill= Classes))+
  labs(title = "FWI por Región e incendio")+
  geom_boxplot()
```

Observando los resultados de los analisis de Bejaia y Sidi-Bel_Abbes
podemos decir: Por un lado, tanto en Bejaia como en Sidi se puede
observar una gran disparidad en los datos de cuando hubo incendios y no
con respecto a el FWI, lo cual significa que a menor indice
meteorológico de incendios menos incendios hay y viceversa. Podemos
concluir entonces que el FWI esta directamente relacionado con los
incendios ya que con la ausencia de este los incendios son inexistentes.

Tambien se observa tanto en los graficos como en los resultados de la
mediana cuando han habido y no incendios en Bejaia (9.7 y 0.5
respectivamente) y en Sidi (11.45 y 0.7 respectivamente), que en Sidi el
FWI medio es mayor lo que prueba que en Sidi hayan mas incendios que en
Bejaia.

Vamos a calcular ahora la asimetria y el apuntamiento con respeco a el
FWI en Bejaia

```{r}
ggplot(Bejaia, aes(x= FWI)) +
  geom_histogram(bins = 30, color ="black", fill ="steelblue")

Asimetria <- skew(Bejaia$FWI); Asimetria
Curtosis <- kurtosi((Bejaia$FWI)); Curtosis
```

Tras el calculo de la asimetria y la curtosis se ve claramente en el
grafico la asimetria a la derecha que se comprueba, ya que el resultado
de la asimetria es positivo , además la forma de los datos es
leptocúrtica por que la curtosis es \>0.

Calculamos ahora lo mismo pero para Sidi:

```{r}
ggplot(Sidi, aes(x= FWI)) +
  geom_histogram(bins = 30, color ="black", fill ="steelblue")

Asimetria <- skew(Sidi$FWI); Asimetria
Curtosis <- kurtosi((Sidi$FWI)); Curtosis
```

En el caso de Sidi aunque la asimetria es igual que en Bejaia
(asimetrico a la derecha como se observa en la grafica), hay una clara
diferencia de la forma de los datos ya que en este caso son
platicurticos debido al resultado negativo en la curtosis

6.  FFMC (Fine Fuel Moisture Code)

6.1 Gráfico

```{r}
ggplot(tabla, aes(x = Region, y = FFMC, fill = Classes)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "FFMC por Region e Incendio",
       subtitle = "Fine Fuel Moisture Code - Humedad de combustibles finos",
       x = "Tipo", 
       y = "FFMC") +
  theme_minimal()
```

Tras ver el gráfico, podemos determinar que en ambas regiones, a partir
del valor 80 de FFMC, se producen incendios, y por debajo no hay
incendios.

El boxplot muestra la distribución de FFMC en cada categoría La caja
representa el 50% central de los datos, las líneas los extremos

6.2 Estadísticas por tipo de incendios

```{r}
ffmc_stats <- tabla %>%
  group_by(Classes) %>%
  summarise(
    Media = (mean(FFMC)),
    Mediana = (median(FFMC)),
    Minimo = (min(FFMC)),
    Maximo = (max(FFMC)),
    Desviacion = mean(abs(FFMC-Mediana))
  )
ffmc_stats
```

Los resultados muestran una clara diferencia en los valores de FFMC
entre días con y sin incendios. Los días con incendios ("fire")
presentan valores más altos de FFMC (media de 87.253 y 65.3), lo que
confirma que la baja humedad en combustibles finos es un factor
determinante para la ocurrencia de incendios forestales. La mediana de
87.8 en días con incendios indica que más del 50% de estos eventos
ocurren cuando el FFMC supera este valor, mientras que en días sin
incendios la mediana es de apenas 68.25.

```{r}
ffmc_region <- tabla %>%
  filter(complete.cases(FFMC, Region, Classes)) %>%
  group_by(Region, Classes) %>%
  summarise(FFMC_Promedio = round(mean(FFMC), 1), .groups = 'drop')
cat("FFMC promedio por región y tipo de incendio:\n")
print(ffmc_region)
```

Queda confirmado que en ambas regiones, FFMC \>80 implica que haya
incendios y \<70 que no los haya. -Sidi-Bel_Abbes: 88.3 con incendios y
67.9 sin incendios -Bejaia: 86.6 con incendios vs 63.5 sin incendios
-Sidi-Bel_Abbes muestra mayor riesgo potencial con valores más altos.

7.  DC (Drought Code)

7.1 Gráfico

```{r}
ggplot(tabla, aes(x = Region, y = DC, fill = Classes)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "DC vs Ocurrencia de Incendios",
       subtitle = "Drought Code - Severidad de la sequía",
       x = "Tipo de día", 
       y = "DC") +
  theme_minimal()
```

En AMBAS regiones, los días con incendios tienen valores de DC mucho más
altos que los dias sin incendios. En ambas regiones, los incendios
ocurren con DC más alto: \~80-150 y \~10-80 sin incendios.
Sidi-Bel_Abbes muestra valores más extremos (DC hasta 200 con incendios)
vs Bejaia (máx \~180).

Los puntos negros representan valores atípicos (outliers) - datos que se
encuentran por fuera del rango normal de distribución. -En días SIN
incendios ("not fire"): varios puntos arriba indican días con DC -En
días CON incendios ("fire"): puntos abajo muestran incendios que
ocurrieron

7.2 Estadísticas por tipo de incendio

```{r}
dc_stats <- tabla %>%
  group_by(Classes) %>%
  summarise(
    Media = (mean(DC)),
    Mediana = (median(DC)),
    Minimo = (min(DC)),
    Maximo = (max(DC)),
    Desviacion = mean(abs(DC-Mediana))
  )
dc_stats
```

Podemos observar que cuando hay inciendios el DC más alto es 70.81 \>
que cuando no hay incendios

DC por región

```{r}
dc_region <- tabla %>%
  filter(complete.cases(DC, Region, Classes)) %>%
  group_by(Region, Classes) %>%
  summarise(DC_Promedio = round(mean(DC), 1), .groups = 'drop')
print(dc_region)
```

7.3 CONCLUSIONES

podemos decir que Ambas regiones siguen el mismo patrón: DC \>90 con
incendios y \<30 sin incendios de modo que : Sidi-Bel_Abbes: 98.3 con
incendios (más severo) vs 29.3 sin incendios Bejaia: 90.8 con incendios
y 28.6 sin incendios entonces DC \>50 = alto riesgo en ambas zonas.

7.4 RELCIÓN ENTRE FFMC Y DC

```{r}

correlacion <- cor(tabla$FFMC, tabla$DC, use = "complete.obs")
print(round(correlacion, 3))
```

Valor = 0.507 → Correlación positiva Esto significa que cuando FFMC
aumenta, DC también tiende a aumentar, entonces no es una correlación
perfecta (1.0), otros factores también influyen.

8.  BUI

La siguiente variable que vamos a analizar es la acumulación de
combustible (BUI) en ambas zonas, con tal de ver si esto afecta
directamente a la aparición de incendios.

```{r}
Bui_media_bf <- Bejaia_fire %>% 
  summarise(maximo= max(BUI),
            minimo= min(BUI),
            media= mean(BUI),
            mediana= median(BUI),
            Dm_me = mean(abs(BUI-  mediana)),
            var= mean((BUI- media)^2),
            sd= sqrt(var),
            CV= sd/media,
            DV= mean(abs(BUI- mediana)),
            );Bui_media_bf

Bui_media_bnf <- Bejaia_not_fire %>% 
  summarise(maximo= max(BUI),
            minimo= min(BUI),
            media= mean(BUI),
            mediana= median(BUI),
            Dm_me = mean(abs(BUI-  mediana)),
            var= mean((BUI- media)^2),
            sd= sqrt(var),
            CV= sd/media,
            DV= mean(abs(BUI- mediana)),
            );Bui_media_bnf

ggplot(tabla, aes(x= Region, y= BUI, fill= Classes))+
  geom_boxplot()+
  labs(title= "BUI por Región e incendio")
```

Como podemos ver en ambos gráficos, observamos que entre un (0-10)% de
BUI no suele haber incendios, esto tiene sentido ya que a menor cantidad
de material inflamable menor es la posibilidad de generar un incendio.

Además, En ambas regiones, la media de BUI es bastante superior a los
dias sin fuego por lo que evidentemente el riesgo de incendio aumenta a
mayor acumuulación de combustible. Por ejemplo, la media de Bejaia en
dias de fuego es de 24,5 y los dias sin incendios 6.8.

Por otra parte la varianza alta en los dias de fuego (+200) indica que
el BUI suele variar y no hay un valor que se repita constantemente, pero
siendo habitual que supere el 15%. En cambio, los dias sin incendios hay
una varianza mas baja(40), lo que nos dice que el BUI se mantiene bajo
(entre el 0-10%).

Ahora vamos a añadir las variables ISI(índice de propagación inicial) y
Ws(velocidad del viento) para comparar las dos al mismo tiempo en un
gráfico.

Primero vamos con ISI, con los datos de Sidi-Bel_Abbes:

```{r}
Isi_media_sf <- Sidi_fire %>% 
  summarise(maximo= max(ISI),
            minimo= min(ISI),
            media= mean(ISI),
            mediana= median(ISI),
            Dm_me = mean(abs(ISI-  mediana)),
            var= mean((ISI- media)^2),
            sd= sqrt(var),
            CV= sd/media,
            DV= mean(abs(ISI- mediana)),
            );Isi_media_sf

Isi_media_snf <- Sidi_not_fire %>% 
  summarise(maximo= max(ISI),
            minimo= min(ISI),
            media= mean(ISI),
            mediana= median(ISI),
            Dm_me = mean(abs(ISI-  mediana)),
            var= mean((ISI- media)^2),
            sd= sqrt(var),
            CV= sd/media,
            DV= mean(abs(ISI- mediana)),
            );Isi_media_snf
```

Ahora hacemos lo mismo pero para la velocidad del viento:

```{r}
Ws_media_sf <- Sidi_fire %>% 
  summarise(maximo= max(Ws),
            minimo= min(Ws),
            media= mean(Ws),
            mediana= median(Ws),
            Dm_me = mean(abs(Ws-  mediana)),
            var= mean((Ws- media)^2),
            sd= sqrt(var),
            CV= sd/media,
            DV= mean(abs(Ws- mediana)),
            );Ws_media_sf

Ws_media_snf <- Sidi_not_fire %>% 
  summarise(maximo= max(Ws),
            minimo= min(Ws),
            media= mean(Ws),
            mediana= median(Ws),
            Dm_me = mean(abs(Ws-  mediana)),
            var= mean((Ws- media)^2),
            sd= sqrt(var),
            CV= sd/media,
            DV= mean(abs(Ws- mediana)),
            );Ws_media_snf
```

Una vez tenemos los datos de ambas variables, las comparamos en un mismo
gráfico para ver si tienen alguna correlación directa:

```{r}
ggplot(tabla, aes(x= id))+
  geom_line(aes(y= ISI), color= "red")+
  geom_line(aes(y= Ws), color= "blue")+
  labs(title= "ISI(rojo) y Ws(Azul) en ambas zonas")+
  theme_minimal()
cor(Sidi$ISI, Sidi$Ws)
cor(Bejaia$ISI, Bejaia$Ws)
```

Tras analizar el gráfico y tener un valor cor(correlación) muy bajo
(0.12) en Sidi-Bel_Abbes y -0.03 en Bejaia, podemos concluir que aunque
el viento pueda incrementar ligeramente el valor de ISI, no es un factor
determinante para decir que a mayor velocidad de viento, mayor índice de
propagación, Aunque pueda parecer lógico la relación no se da porque
seguramente cuando en estas regiones hay viento es cuando más humedad
haya y por tanto no se produzcan indencios, igualmente esto son solo
suposiciones que más adelante comprobamos si son ciertas.

Además,esto indica que probablemente otras variables como la humedad de
la región o la acumulación de combustible sean más determinantes. Para
ello vamos a comparar el viento con el BUI.

```{r}
ggplot(tabla, aes(x= id))+
  geom_line(aes(y= ISI), color= "red")+
  geom_line(aes(y= BUI), color= "green")+
  labs(title= "ISI(rojo) y BUI(Verde) en ambas zonas")+
  theme_minimal()
cor(Sidi$ISI, Sidi$BUI)
cor(Bejaia$ISI, Bejaia$BUI)
```

Aquí sí podemos ver que hay una correlación muy alta en Sidi(\>0.6) e
incluso aún más en Bejaia(\>0.7), lo que significa que cuando hay una
mayor cantidad de combustible, el fuego se propaga más rápidamente y nos
indica que la cantidad de BUI es un factor determinante para la
propagación del fuego.

