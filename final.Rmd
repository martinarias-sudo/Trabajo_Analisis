---
title: "proyecto_final"
output: html_document
date: "2025-11-05"
---

Cargar las librerías y la base de datos y limpiarla
```{r}
library(dplyr)
library(ggplot2)
library(modeest)
library(stringr)

tabla <- read.csv("bd1_8.csv", sep=";", header= TRUE)
head(tabla)


# Limpiamos la tabla de datos
tabla <- tabla %>%
  mutate(across(where(is.character), ~trimws(.)))

```

Vamos a ver cómo es la base de datos
```{r}
ggplot(tabla, aes(x=Region, fill=Classes))+
  geom_bar()
```

Seleccionar sólo Bejaia de la base de datos así como si hubo incendio o no
```{r}
# Filtramos por Bejaia
Bejaia <- tabla %>% 
  filter(Region == "Bejaia")

#Filtramos por Bejaia y si hay o no incendio
Bejaia_fire <- Bejaia %>%
  filter(Classes == "fire")
Bejaia_not_fire <- Bejaia %>% 
  filter(Classes == "not fire")

# Filtramos por Sidi
Sidi <- tabla %>% 
  filter(Region == "Sidi-Bel_Abbes")

#Filtramos por Bejaia y si hay o no incendio
Sidi_fire <- Sidi %>%
  filter(Classes == "fire")
Sidi_not_fire <- Sidi %>% 
  filter(Classes == "not fire")
```

Vemos como quedan los incendios en cada zona
```{r}
ggplot(tabla, aes(Region, fill=Classes))+
  geom_bar()
```
Tras el gráfico, vemos que en Bejaia los días con fuego y sin fuego son casi los mismos. En cambio, en Sidi-Bel_Abbes, vemos claramente que han habido más días con incendios que sin. 

Hacemos las tablas de frecuencias
```{r}
Bejaia_frecuencias <- Bejaia %>% 
  group_by(Classes) %>% 
  summarise(ni = n()) %>% 
  mutate(fi = round(ni/sum(ni), 4)) %>% 
  mutate(fi_porc = round(fi*100, 2));Bejaia_frecuencias

Sidi_frecuencias <- Sidi %>% 
  group_by(Classes) %>% 
  summarise(ni = n()) %>% 
  mutate(fi = round(ni/sum(ni), 4)) %>% 
  mutate(fi_porc = round(fi*100, 2));Sidi_frecuencias
```
Tras hacer las frecuencias, vemos que en Bejaia hay igualdad en días de incendios, mientras que en Sidi, casi el doble de días con fuego que sin fuego.

A continuación vamos a determinar qué factores contribuyen a los incendios. Puesto que hay dos regiones distintas, los factores que contribuyen a incendios varían de una zona a otra.

En primer lugar empezaremos analizando la zona de Bejaia. En concreto la lluvia
```{r}
lluvia_media_Bf <- Bejaia_fire %>% 
  summarize(máximo = max(Rain),
            mínimo = min(Rain),
            media = mean(Rain),
            var = mean((Rain - media)^2),
            sd = sqrt(var)
            );lluvia_media_Bf
lluvia_media_Bnf <- Bejaia_not_fire%>% 
  summarize(máximo = max(Rain),
            mínimo = min(Rain),
            media = mean(Rain),
            mediana = median(Rain),
            DM_me= mean(abs(Rain - mediana)),
            var = mean((Rain - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(Rain-mediana))
            );lluvia_media_Bnf
ggplot(Bejaia, aes(x=Rain, y=0, color=Classes))+
  geom_point()

```
En el gráfico observamos que los días que hubieron incendios, no ha habido lluvia. En cambio, los días en los que no han habido incendios, sí ha llovido algo. Esto tiene sentido ya que si llueve, es más dificil que se produzca un incendio.
Vemos además en que la media de lluvia de los días con fuego es de casi 0 (0.01) y los días en los que no hubieron incendios, la median es de 0.5.
