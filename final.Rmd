---
title: "proyecto_final"
output: html_document
date: "2025-11-05"
---

Cargar las librerías y la base de datos y limpiarla
```{r}
library(dplyr)
library(ggplot2)
library(modeest)
library(stringr)

tabla <- read.csv("bd1_8.csv", sep=";", header= TRUE)
head(tabla)

# Limpiamos la tabla de datos
tabla <- tabla %>%
  mutate(across(where(is.character), ~trimws(.)))
tabla$id <- 1:nrow(tabla)
```

Seleccionar sólo Bejaia de la base de datos así como si hubo incendio o no
```{r}
# Filtramos por Bejaia
Bejaia <- tabla %>% 
  filter(Region == "Bejaia")

#Filtramos por Bejaia y si hay o no incendio
Bejaia_fire <- Bejaia %>%
  filter(Classes == "fire")
Bejaia_not_fire <- Bejaia %>% 
  filter(Classes == "not fire")

# Filtramos por Sidi
Sidi <- tabla %>% 
  filter(Region == "Sidi-Bel_Abbes")

#Filtramos por Bejaia y si hay o no incendio
Sidi_fire <- Sidi %>%
  filter(Classes == "fire")
Sidi_not_fire <- Sidi %>% 
  filter(Classes == "not fire")

#Cuando hay o no fuego
not_fire <- tabla %>% 
  filter(Classes == "not fire")
fire <- tabla %>% 
  filter(Classes == "fire")
```

Vemos como quedan los incendios en cada zona
```{r}
ggplot(tabla, aes(Region, fill=Classes))+
  geom_bar()
```
Tras el gráfico, vemos que en Bejaia los días con fuego y sin fuego son casi los mismos. En cambio, en Sidi-Bel_Abbes, vemos claramente que han habido más días con incendios que sin. 

Hacemos las tablas de frecuencias
```{r}
Bejaia_frecuencias <- Bejaia %>% 
  group_by(Classes) %>% 
  summarise(ni = n()) %>% 
  mutate(fi = round(ni/sum(ni), 4)) %>% 
  mutate(fi_porc = round(fi*100, 2));Bejaia_frecuencias

Sidi_frecuencias <- Sidi %>% 
  group_by(Classes) %>% 
  summarise(ni = n()) %>% 
  mutate(fi = round(ni/sum(ni), 4)) %>% 
  mutate(fi_porc = round(fi*100, 2));Sidi_frecuencias
```
Tras hacer las frecuencias, vemos que en Bejaia hay igualdad en días de incendios, mientras que en Sidi, casi el doble de días con fuego que sin fuego.

A continuación vamos a determinar qué factores contribuyen a los incendios. Puesto que hay dos regiones distintas, los factores que contribuyen a incendios varían de una zona a otra.

En primer lugar empezaremos analizando la zona de Bejaia. En concreto la lluvia
```{r}
lluvia_media_Bf <- Bejaia_fire %>% 
  summarize(máximo = max(Rain),
            mínimo = min(Rain),
            media = mean(Rain),
            var = mean((Rain - media)^2),
            sd = sqrt(var)
            );lluvia_media_Bf

lluvia_media_Bnf <- Bejaia_not_fire%>% 
  summarize(máximo = max(Rain),
            mínimo = min(Rain),
            media = mean(Rain),
            mediana = median(Rain),
            DM_me= mean(abs(Rain - mediana)),
            var = mean((Rain - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(Rain-mediana))
            );lluvia_media_Bnf
ggplot(tabla, aes(x=Region, y=Rain, color=Classes))+
  geom_boxplot()
```
En el gráfico observamos que los días que hubieron incendios, no ha habido lluvia. En cambio, los días en los que no han habido incendios, sí ha llovido algo. Esto tiene sentido ya que si llueve, es más dificil que se produzca un incendio.
Vemos además en que la media de lluvia de los días con fuego es de casi 0 (0.01) y los días en los que no hubieron incendios, la mediana es de 0.5.



El siguiente dato que vamos a analizar es el RH (Humedad relativa, en %)
```{r}
ggplot(tabla, aes(x=Region, y=RH, color=Classes))+
  geom_boxplot()
ggplot(tabla, aes(x=Region, y=RH, color=Classes))+
  geom_point(alpha=0.3)
```
En bejaia la humedad relativa no da mucha información, los datos no están claramente separados según si hay o no incendios. En el caso de Sidi, vemos que entre 20% y casi 50% de RH, hay fuego
```{r}
min_RH_sidinf <- min(Sidi_not_fire$RH);min_RH_sidinf
```
Vemos que entre un 20% y un 42%, podemos determinar que hay incendios en Sidi



Ahora vamos a ver como afecta DMC a los incendios
```{r}
ggplot(tabla, aes(x=Region, y=DMC, color=Classes))+
  geom_boxplot()
```
En el gráfico vemos que cuando no hay incendios, los valores de DMC son más bajos que cuando hay incendios. En este caso, son parecidos las dos regiones, cuando hay incendios, los valores pueden estar entre 16 y casi 65, mientras que cuando no hay incendios, suelen estar por debajo de 15. DMC se ve afectado por la temperatura, humaedad relativa y lluvia.
```{r}
ggplot(tabla, aes(Rain, DMC, color=Classes))+
  geom_point()
ggplot(tabla, aes(x = id)) +
  geom_line(aes(y = Rain), color = "blue") +
  geom_line(aes(y = DMC), color = "red")
cor(Bejaia$DMC,Bejaia$Rain)
```
Vemos en el gráfico de líneas que la Lluvia afecta directamente a DMC, cuando no llueve el mantillo está menos humedo y cuando llueve está más húmedo. A menor valor de DMC, mayor será la humedad. 
En el gráfico de puntos vemos que esto es correcto, a mayor lluvia menor humedad en el mantillo y viceversa.


vamos a continuar analizando los incendios pero ahora centrados en la temperatura
```{r}
temperatura_media_Bf <- Bejaia_fire %>% 
  summarize(máximo = max(Temperature),
            mínimo = min(Temperature),
            media = mean(Temperature),
            var = mean((Temperature - media)^2),
            sd = sqrt(var)
            );temperatura_media_Bf
temperatura_media_Bnf <- Bejaia_not_fire%>% 
  summarize(máximo = max(Temperature),
            mínimo = min(Temperature),
            media = mean(Temperature),
            mediana = median(Temperature),
            DM_me= mean(abs(Temperature - mediana)),
            var = mean((Temperature - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(Temperature-mediana))
            );temperatura_media_Bnf
temperatura_media_Sf <- Sidi_fire %>% 
  summarize(máximo = max(Temperature),
            mínimo = min(Temperature),
            media = mean(Temperature),
            var = mean((Temperature - media)^2),
            sd = sqrt(var)
            );temperatura_media_Sf
temperatura_media_Snf <- Sidi_not_fire%>% 
  summarize(máximo = max(Temperature),
            mínimo = min(Temperature),
            media = mean(Temperature),
            mediana = median(Temperature),
            DM_me= mean(abs(Temperature - mediana)),
            var = mean((Temperature - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(Temperature-mediana))
            );temperatura_media_Snf

ggplot(tabla, aes(x=Region, y=Temperature, color=Classes))+
  geom_boxplot()
```

Tras el analisis de las temperaturas en Bejaia cuando han habido incendios y no, podemos concluir, que las altas temperaturas no indican que siempre vaya a haber incendios, ya que al igual que han habido incendios con temperaturas superiores a 30 grados, hay veces en las que en estas temperaturas no han habido incendios como se puede observar en la gráfica. 

Sin embargo también podemos notar que cuanto mas bajas son las temperaturas menos incendios hay, esto se prueba observando las temperaturas minimas cuando ha habido incendio (26 Cº) y cuando no lo ha habido (22 Cº)

Tas el analisis de los incendios con respecto a la temperatura en Sidi-Bel_Abbes podemos observar claras diferencias con Bejaia, en primer lugar las temperaturas en esta zona son mucho mas elevadas (tanto cuando ha habido incendios como no), además que al contrario que en Bejaia aquí las altas temperaturas por lo general si suelen conllevar siempre a la aparicion de incendios y las bajas temperaturas a la ausencia de estos tal como se observa en el gráfico.


Ahora por lo que respecta al índice meteorológico de incendios FWI tenemos:
```{r}
FWI_media_Bf <- Bejaia_fire%>% 
  summarize(máximo = max(FWI),
            mínimo = min(FWI),
            media = mean(FWI),
            mediana = median(FWI),
            DM_me= mean(abs(FWI - mediana)),
            var = mean((FWI - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(FWI-mediana))
            );FWI_media_Bf
FWI_media_Bnf <- Bejaia_not_fire%>% 
  summarize(máximo = max(FWI),
            mínimo = min(FWI),
            media = mean(FWI),
            mediana = median(FWI),
            DM_me= mean(abs(FWI - mediana)),
            var = mean((FWI - media)^2),
            sd = sqrt(var),
            CV = sd/media,
            DV = mean(abs(FWI-mediana))
            );FWI_media_Bnf
ggplot(tabla, aes(Region, FWI, color= Classes))+
  geom_boxplot()
```





